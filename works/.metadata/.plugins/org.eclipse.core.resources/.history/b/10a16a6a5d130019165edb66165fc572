#define DMA (int *) 0x23020
#include "io.h"
#include "stdio.h"
#include "system.h"

int length = 32;
int control = 8;
int readLength = 20;
//int enable = 1;

char pdata0[32] = {0, 1, 2, 3, 4, 5, 6, 7,
					8, 9, 10, 11, 12, 13, 14, 15,
					16, 17, 18, 19, 20, 21, 22, 23,
					24, 25, 26, 27, 28, 29, 30, 31};
char *pdata1 = (char*) (ONCHIP_MEMORY2_1_BASE);


void handlerStatus()
{
	int i;
	for (i = 0; i < 32; i++)
	{
		printf("Byte %d = %d \n", i, pdata1[i]);
	}
}
int main()
{
	int i;
	char *a = pdata0;
	char *b = pdata1;
	IOWR_32DIRECT(DMA,0*4, (int)pdata0 );
	IOWR_32DIRECT(DMA, 1*4, (int)pdata1 );
	IOWR_32DIRECT(DMA, 2*4, length);
	IOWR_32DIRECT(DMA, 3*4, control);
	for (i = 0; i < 1000; i++){
		if((IORD_32DIRECT(DMA, 7*4)) == 1){
					handlerStatus();
				}
	}
	while(1)
	{

	}

	return 0;
}

